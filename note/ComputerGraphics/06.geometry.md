# geometry 几何

纹理： 一张图。 在现代Gpu中，可以理解成一个内存，可以对区域进行操作，点查询、区域查询等。

### 环境光照/ 环境贴图 Environment Map 
> 任何方向的光， 纹理可以用来描述环境光怎么样， 只记录方向， 设为无限远。
> 描述不同方向的光照，不同的环境光可以记录在球上并展开，但是在靠近极点的点放会扭曲，因此我们可以把环境光纪录在立方体上， cubemap。

**凹凸贴图/法线贴图**
> 可以定义相对高度。 同时法线会发生变化， shading会发生变化。

可以定义复杂的纹理， 不改变几何，通过定义高度差来改变法线。

**flatland**

n(p) = (0,1);

切线： dp = c * [h(p+1)-h(p)]；

法线： n(p) = (-dp, 1)  最后归一化

定义局部坐标系， 认为法线永远是（0，0，1), 然后转换为世界坐标。

二维： 

n(p) = (0,0,1);

dp/du = c1 * [h(u+1) - h(u)]
dp/dv = c2 * [h(v+1) - h(v)]

**位移贴图**
> 就把不同的顶点真的作出移动， 要求模型的面足够多，采样率足够高

directX可以做到动态曲面区分

**3d纹理**

三维空间中噪声函数

经常用在体积渲染

例如医学上核磁共振扫描后形成的三维 的应用

## 阴影
> 环境光遮蔽,计算好后贴上，着色结果乘以环境光遮蔽纹理。



## 几何


1. 隐式几何： 告知点之间的特定关系，表示一定的关系 例如x^2 + y^2 + z^2 = 1;

  csg：通过一些基本几何合成

  df距离函数： 描述点到想要的几何的最近距离

  面与光线求交

2. 显式关系： 直接给出或者参数映射

  点云， 多边形面

## 贝塞尔曲线/贝塞尔曲面

1. 必定经过起始与终止控制点

2. 必定经与起始与终止线段相切

3. 具有仿射变换性质（平移/旋转/缩放。。），可以通过移动控制点移动整条曲线

4. 凸包性质，曲线一定不会超出所有控制点构成的多边形范围

逐段定义贝塞尔，每四个点定义一个贝塞尔曲线，

两种连续的曲线

伯恩斯坦多项式

样条： 连续的曲线是有一系列的控制点控制的，可控的曲线

b-splines： 奇函数， 贝塞尔曲线的扩展，局部性质

**贝塞尔曲面**

**mesh 网格**

3. mesh regularization 三角形正规化

loop细分法则： 只能用作三角形面

表面细分： 三角形数量增多， 新老节点位置发生改变。

3/8*（A+B） + 1/8*（C+D）

n(度): 顶点链接边的数

u： 与度有关的数

1 - n * u 来进行加权

**catmull-clark subdivision** ： 网格细分方式

奇异点： 度不为4的点， 非四边形面引入奇异点后都会消失

**曲面简化**

1. edge collapsing 坍缩  (后续再研究算法这块具体怎么写)

> 二次误差度量： 优先队列或者最小堆， O(1) 取到二次误差度量最小值

> 局部最优解找到全局最优解， 贪心算法

### 光栅化阴影

全局光线问题   ---- 光线追踪

着色是局部的现象  

**shadow mapping** 图像空间， 生成阴影的时候不用考虑场景的几何信息， 但是会产生走样现象。
> 只能处理点光源，会有明显的阴影边界，硬阴影

1. 从光源看场景放虚拟相机， 记录点的深度shadow maps本身分辨率。

2. 从实际相机出发看向场景， 将看到的点投影回虚拟相机成像平面上， 比较当前的点的深度与之前记录的是否一致， 实际场景中，浮点数很难相等， 我们可以判断大小不判断相等， 数值精度问题处理，不能本质解决问题。 

出现软阴影一定是因为光源有一定的大小


#### 间接光照： 光线经过多次弹射到达人的眼睛















































































