# 代码优化

#### 如何精准测试JS性能

* 本质上就是采集大量的执行样本进行数学统计和分析

* 使用基于Benchmaerk.js的https://jsperf.com/ 完成

1. 使用Github账号登录

2. 填写个人信息（非必填）

3. 填写详细的测试用例信息（title）

4. 填写准备代码（DOM操作时经常使用）

5. 填写测试代码片段

#### 慎用全局变量

* 全局变量在全局执行上下文，是所有作用域链的顶端

* 全局执行上下文一直存在于上下文执行栈，知道程序退出

* 如果某个局部作用域出现了同名变量则会遮蔽或者污染全局

#### 缓存全局变量

> 将使用中无法避免的全局变量缓存到局部

#### 通过原型新增方法

js中存在构造函数、原型对象、实例对象

实例和构造函数指向原型对象

在原型对象上新增实例对象需要的方法

#### 避开闭包陷阱

* 闭包是一种强大的语法

* 闭包使用不当很容易造成内存泄露

* 不要为了闭包而闭包

#### 避免属性访问方法使用

* JS不需属性的访问方法， 所有属性都是外部可见的

* 使用属性访问方法只会增加一层重定义， 没有访问的控制力


#### for循环优化

```
for(let i = arr.length; i; i++) {
  console.log(i)
}
```

#### 采用最优循环方式

    forEach  > for > for in 


#### 节点添加优化

  * 节点的添加操作必然会有回流和重绘操作

  * 文档碎片 

  * 先添加至文档碎片最后添加入body

#### 克隆优化节点操作

#### 直接量替换Object

```
var a = [1, 2, 3]  √


var a1 = new Array(3);
a1[0] = 1;
a1[1] = 1;
a1[2] = 1;

```









